<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <!--<script type="text/javascript" src="/webjars/jquery/3.3.1/jquery.js"></script>-->
    <!--<script type="text/javascript" src="/webjars/echarts/4.0.4/dist/echarts.js"></script>-->
    <!--<script type="text/javascript" src="/webjars/echarts/4.0.4/dist/echarts.common.min.js"></script>-->
    <script th:src="@{echarts.common.min.js}" type="text/javascript"></script>
    <script th:src="@{jquery-3.1.1.js}" type="text/javascript"></script>
    <title>体重</title>
</head>
<script type="text/javascript">
    var option;
    var myChart;
    var myChart2;
    var option2;

    $(function () {
        initChart();
        initChart2();
        //基于准备好的dom，初始化echarts实例
        myChart = echarts.init(document.getElementById('main'));
        myChart2 = echarts.init(document.getElementById('main2'));
        //myChart.setOption(option)
        showWeight();
        showWeight2();
    });

    function downloadIamge() {
        var datas = [];
        var data = myChart.getDataURL("png");
        var data2 = myChart2.getDataURL("png");
        datas.push(data.split(",")[1]);
        datas.push(data2.split(",")[1]);
        $.ajax({
            type: "POST",
            url: "localhost:8080/download/downloadImage",
            contentType: 'application/json;charset=UTF-8',
            data: JSON.stringify({
                img1Desc: 'aaaa',
                img2Desc: 'bbb',
                imgUrls: datas
            })
        });
    }

    function showWeight() {
        initChart();
        //option.title.text = r.username+"的体重"
        option.legend.data[0] = 'test'
        option.series[0] = {"name": 'test', "type": "line", "data": []}
        //option.series[0].name = r.username
        //option.series[0].type = 'line'
        // for (var i in r.weights) {
        //     option.series[0].data[i] = r.weights[i].weight
        //     option.xAxis[0].data[i] = r.weights[i].wdate
        // }
        // for (var i in r) {
        //     option.series[0].data[i] = r.name
        //     option.xAxis[0].data[i] = r.age
        // }
        //option.series[1] = {"name": r.username, "type": "line", "data": [1,2,8,12,21,9]}
        myChart.setOption(option)
    }

    function showWeight2() {
        initChart2();
        option.legend.data[0] = 'test'
        option.series[0] = {"name": 'test', "type": "line", "data": []}
        myChart2.setOption(option2)
    }


    function initChart() {
        option = {
            title: {
                text: "体重趋势表",
                x: "center"
            },
            tooltip: {
                trigger: "item",
                formatter: "{a} <br/>{b} : {c}kg"
            },
            legend: {
                x: 'left',
                data: [1, 2, 3, 4, 5]
            },
            xAxis: [
                {
                    type: "category",
                    name: "日期",
                    splitLine: {show: false},
                    data: [12, 13, 14, 15]
                }
            ],
            yAxis: [
                {
                    type: "value",
                    axisLabel: {
                        formatter: '{value} kg'
                    },
                    name: "体重",
                    max: 90,
                    min: 50,
                    splitNumber: 5,
                    data: []
                }
            ],
            toolbox: {
                show: true,
                feature: {
                    mark: {
                        show: true
                    },
                    dataView: {
                        show: true,
                        readOnly: true
                    },
                    restore: {
                        show: true
                    },
                    saveAsImage: {
                        show: true
                    }
                }
            },
            calculable: true,
            series: []
        };
    }

    function initChart2() {
        option2 = {
            title: {
                text: "体重趋势表22",
                x: "center"
            },
            tooltip: {
                trigger: "item",
                formatter: "{a} <br/>{b} : {c}kg"
            },
            legend: {
                x: 'left',
                data: [1, 2, 3, 4, 5]
            },
            xAxis: [
                {
                    type: "category",
                    name: "日期",
                    splitLine: {show: false},
                    data: [12, 13, 14, 15]
                }
            ],
            yAxis: [
                {
                    type: "value",
                    axisLabel: {
                        formatter: '{value} kg'
                    },
                    name: "体重",
                    max: 90,
                    min: 50,
                    splitNumber: 5,
                    data: []
                }
            ],
            toolbox: {
                show: true,
                feature: {
                    mark: {
                        show: true
                    },
                    dataView: {
                        show: true,
                        readOnly: true
                    },
                    restore: {
                        show: true
                    },
                    saveAsImage: {
                        show: true
                    }
                }
            },
            calculable: true,
            series: []
        };
    }
</script>


<body>
<h1 style="text-align: center">体重查看页面</h1>
<a href="javascript:void(0)" onclick="downloadIamge()"
   style="text-decoration: none;margin-left: 140px">下载</a>
<!--<a href="javascript:void(0)" onclick="showWeight()"-->
<!--style="text-decoration: none;margin-left: 140px">查看我的体重</a>-->
<div id="main" style="height:460px;width: 85%;margin: 20px auto 0"></div>
<div id="main2" style="height:460px;width: 85%;margin: 20px auto 0"></div>

</body>
</html>